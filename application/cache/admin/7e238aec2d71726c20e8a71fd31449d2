
<div id="viewTools">
	<button data-role="submit" class="btn btn-primary btn-ripple" ng-click="save(true)" ng-disabled="editForm.$invalid">Terminer<i class="fa fa-check-circle"></i></button>
<button data-role="submit" class="btn btn-primary btn-ripple" ng-click="save()" ng-disabled="editForm.$invalid">Sauver<i class="fa fa-save"></i></button>
<a data-role="cancel" class="btn btn-default btn-ripple" href="#/{{backUrl ? backUrl : section}}">Retour<i class="fa fa-reply"></i></a>
<button data-role="delete" ng-if="mode != 'new'" class="btn btn-danger btn-ripple" ng-click="delete()">Supprimer<i class="fa fa-trash-o"></i></button>
<span id="mainAlert">{{alert}}</span>
</div>

<section>
	<h1>Page : #{{item.id}} {{item.name}}</h1>
	<hr />
	<div error-sumary></div>

	<div class="row">
		<div class="col-md-9">
			<form name="editForm" class="form form-horizontal" novalidate>

				<div class="row">
					
					<div class="col-md-6">
						<h3>Identité</h3>
						<hr />

						<div class="form-group">
							<label class="control-label col-sm-2">Nom</label>
							<div class="controls col-sm-6">
								<input type="text" name="name" value="" id="item_name" ng-model="item.name" ng-maxlength="40" data-required="true"  /><div class="label label-danger" ng-show="editForm.name.$error.required && editForm.name.$dirty">Ce champ est requis</div><div class="label label-danger" ng-show="editForm.name.$error.maxlength">Max. 40 caractères.</div>							</div>
						</div>

						<div class="form-group">
							<label class="control-label col-sm-2">Slug</label>
							<div class="controls col-sm-6">
								<input type="text" name="slug" value="" id="item_slug" ng-model="item.slug" ng-maxlength="40" data-required="true" validation="slug"  /><div class="label label-danger" ng-show="editForm.slug.$error.required && editForm.slug.$dirty">Ce champ est requis</div><div class="label label-danger" ng-show="editForm.slug.$error.validation">{{item_slug}}</div><div class="label label-danger" ng-show="editForm.slug.$error.maxlength">Max. 40 caractères.</div>							</div>
						</div>

						<div class="form-group">
							<label class="control-label col-sm-2">Langue</label>
							<div class="controls col-sm-6">
								<select name="lang" ui-select2 ng-model="item.lang">
<option value="fr">fr</option>
<option value="en">en</option>
</select><div class="label label-danger" ng-show="editForm.lang.$error.required && editForm.lang.$dirty">Ce champ est requis</div><div class="label label-danger" ng-show="editForm.lang.$error.maxlength">Max. 2 caractères.</div>							</div>
						</div>

						<div class="form-group">
							<label class="control-label col-sm-2">Parent</label>
							<div class="controls col-sm-6">
								<select ui-select2 name="type" ng-model='item.parent_id' ng-if="pagesList.length > 0">
									<option ng-if="page.id != item.id" ng-repeat="page in pagesList" value="{{page.id}}">{{page.name}}</option>
								</select>
							</div>
						</div>

						<div class="form-group">
							<label class="control-label col-sm-2">Ordre</label>
							<div class="controls col-sm-6">
								<input type="text" name="weight" value="" id="item_weight" ng-model="item.weight" ng-maxlength="10"  /><div class="label label-danger" ng-show="editForm.weight.$error.maxlength">Max. 10 caractères.</div>							</div>
						</div>


					</div>

					<div class="col-md-6">
						<h3>Template</h3>

						<hr />

						<div class="form-group">
							<label class="control-label col-sm-2">Type de template</label>
							<div class="controls col-sm-6">
								<select name="type" ui-select2 ng-model="item.type">
<option value="file">Fichier</option>
<option value="template">Template</option>
</select><div class="label label-danger" ng-show="editForm.type.$error.required && editForm.type.$dirty">Ce champ est requis</div><div class="label label-danger" ng-show="editForm.type.$error.maxlength">Max. 40 caractères.</div>							</div>
						</div>

						<div class="form-group" ng-if="item.type">
							<label class="control-label col-sm-2">{{ item.type === 'template' ? 'Template' : 'Fichier' }}</label>
							<div class="controls col-sm-6">
								<select ng-change="getTemplateFields()" ui-select2 name="type" ng-model='item.template'>
									<option ng-if="item.type === 'file'" ng-repeat="templateFile in templateFiles" value="{{templateFile}}">{{templateFile}}</option>
									<option ng-if="item.type === 'template'" ng-repeat="template in templates" value="{{template.id}}">{{template.name}}</option>
								</select>
							</div>
						</div>

					</div>
				</div>

				<div ng-if="item.type =='template' && item.template != undefined">
					<h3>Contenu</h3>
					<hr />

					<div ng-repeat="templateField in templateFields">
						<h4>{{templateField.name}}</h4>
						<div ng-switch="templateField.type"> 
							<div ng-switch-default>
								<input type="text" ng-model="templateField.fieldValue" />
							</div>
							<div ng-switch-when="textEditor">
								<label class="checkbox">
									<input type="checkbox" ng-model="templateField.raw"> Editeur html
								</label>
								<div ng-if="!templateField.raw" style="min-height: 200px">
									<textarea ui-tinymce="tinymceOptions" ng-model="templateField.fieldValue"  ></textarea>
								</div>
								<div ng-if="templateField.raw" ui-ace="{
								  useWrapMode : true,
								  showGutter: true,
								  theme:'twilight',
								  mode: 'html',
								  onLoad: aceLoaded}" ng-model="templateField.fieldValue" style="height: 200px"></div>
							</div>
							<div ng-switch-when="htmlEditor">
								<div ui-ace="{
								  useWrapMode : true,
								  showGutter: true,
								  theme:'twilight',
								  mode: 'html',
								  onLoad: aceLoaded}" ng-model="templateField.fieldValue" style="height: 200px"></div>
							</div>
							<div ng-switch-when="checkbox">
								<input type="checkbox" ng-checked="templateField.fieldValue == 1" ng-model="templateField.fieldValue">
							</div>
							<div ng-switch-when="gridEditor" class="well">
								<div grid-wizard content="templateField.fieldValue" ></div>
							</div>

							<hr />
						</div>
					</div>
				</div>
			</form>
		</div>

		<div class="col-md-2 col-md-offset-1">
			<aside id="edit-aside" class="well" ng-if="item.created_on">
	<strong>Crée le :</strong> {{item.created_on}} <br />
	<strong>Par : </strong><manager-user-infos userid="item.created_by" ></manager-user-infos>

	<div ng-if="item.modified_on">
		<strong>Modifié le : </strong> {{item.modified_on}} <br />
		<strong>Par : </strong><manager-user-infos userid="item.modified_by" ></manager-user-infos>
	</div>
</aside>			<div class="panel panel-default">
				<div class="panel-body">
					<strong>Version :</strong> {{item.version}}
				</div>
			</div>
			<div class="panel panel-default">
				<div class="panel-heading">
					Meta
				</div>
				<div class="panel-body">
					<label>Titre</label>
					<input type="text" name="meta_title" value="" id="item_meta_title" ng-model="item.meta_title" ng-maxlength="80"  /><div class="label label-danger" ng-show="editForm.meta_title.$error.maxlength">Max. 80 caractères.</div>					<label>Keywords</label>
										<input
						id="page_keywords"
					    type="hidden"
					    ui-select2="select2Tags"
					    ng-model="item.meta_keywords"
					    ng-if="select2Tags.tags && item"
					    >
					<label>Description</label>
					<textarea name="meta_description" cols="40" rows="3" id="item_meta_description" ng-model="item.meta_description" ng-maxlength="300" ></textarea><div class="label label-danger" ng-show="editForm.meta_description.$error.maxlength">Max. 300 caractères.</div>				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading">
					Site Map
				</div>
				<div class="panel-body">
					<div pages-site-map small-size="true" current="mode"></div>
				</div>
			</div>
		</div>
	</div>
</section>